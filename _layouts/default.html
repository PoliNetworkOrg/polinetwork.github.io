<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <!-- Font Awesome -->
    <link
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css"
            rel="stylesheet"
    />
    <!-- Google Fonts -->
    <link
            href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap"
            rel="stylesheet"
    />
    <!-- MDB -->
    <link
            href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/3.3.0/mdb.min.css"
            rel="stylesheet"
    />

    <link rel="stylesheet" type="text/css" href="/res/css/style.css">
    <link rel="stylesheet" type="text/css" href="/res/css/stylenavbar.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="/res/js/search/bootstrap.js"></script>

    <script src="/res/js/search/search3.js"></script>

    <script>
        function generaHTMLrisultato(item) {
          item = applyMapping(item);
          return genHtml(item);
        }

        function  generaHTMLnoresults(){
          var doc = document.getElementById("searchResultsID");
          doc.innerHTML = '<div class=\"result\"><div class="resultContainer"><a class="noResults" href="\https://t.me/PoliGruppo">There are no suggestions for your query. <i>Try asking here</i></a></div></div>';
        }

        function activateResultsDiv(){
          var bar = document.getElementById("searchBarID");
          var container = document.getElementById("searchContainerID");
          if (bar.value.length > 0){
            if (!container.classList.contains("searchResultsActive")){
              container.classList.add("searchResultsActive");
            }
          } else {
            if (container.classList.contains("searchResultsActive")){
              container.classList.remove("searchResultsActive");
            }
          }
        }

        document.addEventListener('DOMContentLoaded', _ => {            // Esegui quando il DOM e' pronto
            els = document.querySelectorAll('input[type="search"]');    // Seleziona tutti gli input di tipo search
            Array.from(els).forEach(el => {                             // Per ogni input di tipo search...
                el.addEventListener('keyup', _ => {                     // Aggiungi un listener che scatta ogni volta che schiacci un tasto sulla tastiera
                    activateResultsDiv();
                    doSearch({                                          // Esegui le search con questa funzione
                        limit: 50,                                      // Limite di risultati per la ricerca
                        join: "AND",                                    // Tipo di join
                        query: {                                        // Ogni proprieta' viene mappata nelle proprieta' degli oggetti del json
                            class: el.value
                        }},
                    data => {
                      var doc = document.getElementById("searchResultsID");
                      console.log("res", data);
                      doc.innerHTML = "";
                      data.forEach((item, i) => {
                        doc.innerHTML += generaHTMLrisultato(item);
                      });
                      if(doc.innerHTML.length == 0){
                        generaHTMLnoresults();
                      }

                    }
                  );                  // Callback in cui passare i risultati di ricerca

                });
            });
        });
    </script>
</head>

    {{ content }}


    <script src="/res/js/javas.js"></script>


</html>
